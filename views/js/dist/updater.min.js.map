{"version":3,"sources":["webpack://MollieModule.[name]/./src/back/updater/index.ts","webpack://MollieModule.[name]/./src/shared/axios.ts"],"names":["showError","message","Promise","all","swal","default","icon","title","get","document","text","xss","then","handleClick","config","translations","steps","action","defaultError","unableToConnect","unableToUnzip","step","axios","endpoint","data","console","error","updated","button","onclick","create","transformResponse","res","JSON","parse","replace","headers"],"mappings":"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","file":"updater.min.js","sourcesContent":["/**\r\n * Copyright (c) 2012-2020, Mollie B.V.\r\n * All rights reserved.\r\n *\r\n * Redistribution and use in source and binary forms, with or without\r\n * modification, are permitted provided that the following conditions are met:\r\n *\r\n * - Redistributions of source code must retain the above copyright notice,\r\n *    this list of conditions and the following disclaimer.\r\n * - Redistributions in binary form must reproduce the above copyright\r\n *    notice, this list of conditions and the following disclaimer in the\r\n *    documentation and/or other materials provided with the distribution.\r\n *\r\n * THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND ANY\r\n * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\r\n * DISCLAIMED. IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE FOR ANY\r\n * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\r\n * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\r\n * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY\r\n * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH\r\n * DAMAGE.\r\n *\r\n * @author     Mollie B.V. <info@mollie.nl>\r\n * @copyright  Mollie B.V.\r\n * @license    Berkeley Software Distribution License (BSD-License 2) http://www.opensource.org/licenses/bsd-license.php\r\n * @category   Mollie\r\n * @package    Mollie\r\n * @link       https://www.mollie.nl\r\n */\r\nimport xss from 'xss';\r\nimport { get } from 'lodash';\r\n\r\nimport axios from '@shared/axios';\r\nimport { ITranslations } from '@shared/globals';\r\n\r\nconst showError = async (message: string): Promise<void> => {\r\n  const [\r\n    { default: swal },\r\n  ] = await Promise.all([\r\n      import(/* webpackPrefetch: true, webpackChunkName: \"sweetalert\" */ 'sweetalert'),\r\n  ]);\r\n  swal({\r\n    icon: 'error',\r\n    title: get(document, 'documentElement.lang', 'en') === 'nl' ? 'Fout' : 'Error',\r\n    text: xss(message),\r\n  }).then();\r\n};\r\n\r\nconst handleClick = async (config: any, translations: ITranslations): Promise<void> => {\r\n  const steps = [\r\n    {\r\n      action: 'downloadUpdate',\r\n      defaultError: translations.unableToConnect,\r\n    },\r\n    {\r\n      action: 'downloadUpdate',\r\n      defaultError: translations.unableToUnzip,\r\n    },\r\n    {\r\n      action: 'downloadUpdate',\r\n      defaultError: translations.unableToConnect,\r\n    },\r\n  ];\r\n\r\n  for (let step of steps) {\r\n    try {\r\n      const { data } = await axios.get(`${config.endpoint}&action=${step.action}`);\r\n      if (!get(data, 'success')) {\r\n        showError(get(data, 'message', step.defaultError)).then();\r\n      }\r\n    } catch (e) {\r\n      console.error(e);\r\n      showError(step.defaultError).then();\r\n    }\r\n  }\r\n\r\n  import(/* webpackPrefetch: true, webpackChunkName: \"sweetalert\" */ 'sweetalert').then(({ default: swal }) => {\r\n    swal({\r\n      icon: 'success',\r\n      text: translations.updated\r\n    }).then();\r\n  });\r\n};\r\n\r\nexport default (button: HTMLElement, config: any, translations: ITranslations) => {\r\n  button.onclick = () => handleClick(config, translations);\r\n};\r\n\r\n","/**\r\n * Copyright (c) 2012-2020, Mollie B.V.\r\n * All rights reserved.\r\n *\r\n * Redistribution and use in source and binary forms, with or without\r\n * modification, are permitted provided that the following conditions are met:\r\n *\r\n * - Redistributions of source code must retain the above copyright notice,\r\n *    this list of conditions and the following disclaimer.\r\n * - Redistributions in binary form must reproduce the above copyright\r\n *    notice, this list of conditions and the following disclaimer in the\r\n *    documentation and/or other materials provided with the distribution.\r\n *\r\n * THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND ANY\r\n * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\r\n * DISCLAIMED. IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE FOR ANY\r\n * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\r\n * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\r\n * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY\r\n * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH\r\n * DAMAGE.\r\n *\r\n * @author     Mollie B.V. <info@mollie.nl>\r\n * @copyright  Mollie B.V.\r\n * @license    Berkeley Software Distribution License (BSD-License 2) http://www.opensource.org/licenses/bsd-license.php\r\n * @category   Mollie\r\n * @package    Mollie\r\n * @link       https://www.mollie.nl\r\n */\r\nimport axios from 'axios';\r\n\r\nexport default axios.create({\r\n  transformResponse: [res => JSON.parse(res.replace(/^[^{[]*/mg, '').replace(/([^}\\]]*)$/mg, ''))],\r\n  headers: {\r\n    'X-Requested-With': 'XMLHttpRequest',\r\n    'Content-Type': 'application/json',\r\n    'Accept': 'application/json',\r\n  },\r\n});\r\n\r\n"],"sourceRoot":""}